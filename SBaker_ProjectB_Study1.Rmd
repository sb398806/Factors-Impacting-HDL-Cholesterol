---
title: "Exploring Factors Impacting HDL Cholesterol in Females Ages 30 - 55"
subtitle: "Using NHANES 2017 - 2020"
author: "Samantha Baker"
date: "`r Sys.Date()`"
output:
  rmdformats::readthedown:
    highlight: kate
    number_sections: TRUE
    code_folding: show
    code_download: TRUE
  html_document:
    df_print: paged
---

# Setup & Data Ingest

## Initial Setup & Package Loads

```{r, message = FALSE, warning=FALSE, cache = FALSE}

library(knitr)
library(rmdformats)

opts_chunk$set(comment=NA)
opts_knit$set(width=75)

```

```{r, message = FALSE, warning=FALSE, cache = FALSE}

library(Epi)
library(janitor) 
library(kableExtra)
library(naniar)
library(nhanesA)
library(tidyverse)

theme_set(theme_bw())

source("Love-boost.R")

```

## Loading Raw Data into R

I downloaded four data files from NHANES, saved them as R data frames, and loaded the raw data into my project.

```{r, message = FALSE}

#demo_raw <- nhanes("P_DEMO") |> tibble()
#saveRDS(demo_raw, "nhanes_demo_raw.RDS")

demo_raw <- readRDS("nhanes_demo_raw.RDS") 

#HDL_raw <- nhanes("P_HDL") |> tibble()
#saveRDS(HDL_raw, "nhanes_HDL_raw.RDS")

HDL_raw <- readRDS("nhanes_HDL_raw.RDS") 

#OHQ_raw <- nhanes("P_OHQ") |> tibble()
#saveRDS(OHQ_raw, "nhanes_OHQ_raw.RDS")

OHQ_raw <- readRDS("nhanes_OHQ_raw.RDS") 

#WHQ_raw <- nhanes("P_WHQ") |> tibble()
#saveRDS(WHQ_raw, "nhanes_WHQ_raw.RDS")

WHQ_raw <- readRDS("nhanes_WHQ_raw.RDS")

```

## Contents of Raw Tibbles

I have four tibbles generated from NHANES 2017 - 2020 data sets: (1) `demo_raw` - Demographic Variables and Sample Weights, containing data on 29 variables for 15,560 subjects; (2) `HDL_raw` - Cholesterol: High-Density Lipoprotein (HDL), containing data on 3 variables for 12,198 subjects; (3) `OHQ_raw` - Oral Health Questionnaire, containing data on 39 variables for 14,986 subjects; and (4) `WHQ_raw` - Weight History Questionnaire, containing data on 35 variables for 10,195 subjects.

```{r}

dim(demo_raw)

dim(HDL_raw)

dim(OHQ_raw)

dim(WHQ_raw)

```

# Cleaning My Data

## Merging Files

I used the `left_join` function to merge my four individual tibbles to create the `NEW3` tibble, matching subjects using the `SEQN` variable. `NEW3` contains data on 103 variables for 15,560 subjects.

```{r}

NEW <- left_join(demo_raw, HDL_raw, by = "SEQN")
NEW2 <- left_join(NEW, OHQ_raw, by = "SEQN")
NEW3 <- left_join(NEW2, WHQ_raw, by = "SEQN")

dim(NEW3)

saveRDS(NEW3, "ProjectB_dataset.RDS")

```

## Checking the Merge

I used the `identical` function to check that the number of unique subject identification codes, `SEQN`, matched the number of rows in the `NEW3` tibble. I have a unique identifier for each row in my data set.

```{r}

identical(n_distinct(NEW3$SEQN), 
          NEW3 |> nrow())

```

## Selecting My Variables

I used the `select` function to choose the variables that I plan to use in my four analyses. `NEW3` contains 9 variables.

```{r}

NEW3 <- NEW3 |>
   select(SEQN, RIDSTATR, RIDAGEYR, RIAGENDR, DMDMARTZ, LBDHDD, WHQ225, 
          OHQ850, OHQ860)

dim(NEW3)

```

## Checking Quantitative Variables

I have two quantitative variables in my `NEW3` tibble: (1) `RIDAGEYR`: age in years and (2) `LBDHDD`: high-density lipoprotein cholesterol (HDL). `RIDAGEYR` ranges from [0-80] years, as expected. `LBDHDD` ranges from [5 - 189] mg/dL. My minimum and maximum values seem extreme. However, the NHANES Laboratory Procedure Manual for HDL-Cholesterol indicates that the clinically reportable range for HDL is [3-200] mg/dL. Part of NHANES data collection includes sending improbable values to the laboratory for further confirmation so I feel comfortable assuming values for `LBDHDD` are reasonable for analysis.

`LBDHDD` has missing data for 4,732 subjects.

**Source**: [NHANES Direct HDL Laboratory Procedure Manual](https://wwwn.cdc.gov/nchs/data/nhanes/2019-2020/labmethods/HDL-K-MET-508.pdf)

```{r, message=FALSE}

NEW3 |>
  select(RIDAGEYR, LBDHDD) |>
  mosaic::inspect()

```

## Binary Variables

I have four binary variables in my `NEW3` tibble: (1) `RIDSTATR`: interview/examination status, (2) `RIAGENDR`: gender (3) `OHQ850`: oral health survey question, "*Have you ever had treatment for gum disease such as scaling and root planing, sometimes called 'deep cleaning'?*", and (4) `OHQ860`: oral health survey question, "*Have you ever been told by a dental professional that you lost bone around your teeth?*". I will also use quantitative variable, `LBDHDD`, to create a fifth binary categorical variable.

To begin, I used the `inspect` function to generate summaries for each variable. I have missing data for 7,707 subjects for both `OHQ850` and `OHQ860`.

```{r}

NEW3 |>
  select(RIDSTATR, RIAGENDR, LBDHDD, OHQ850, OHQ860) |>   mosaic::inspect()

```

I used the `mutate` function to create `OHQ850r` and `OHQ860r`, revised versions of `OHQ850` and `OHQ860`, by changing values representing refusals or answers of "don't know" to missing values. I converted all binary variables from numeric to factor variables and included more meaningful names for each category using the `fct_recode` function. I created one additional binary variable, `LBDHDD_2cat`, using the `LBDHDD` variable to divide subjects into two categories: "At-risk" HDL and "Heart Healthy" HDL, based on guidelines from the Cleveland Clinic. I used the `rename` function to update `RIAGENDR` to `RIASEX` to reflect biological sex rather than gender.

**Source:** [Cleveland Clinic: Cholesterol Numbers & What They Mean](https://my.clevelandclinic.org/health/articles/11920-cholesterol-numbers-what-do-they-mean){.uri}

```{r}

NEW3<- NEW3 |>
  mutate(OHQ850r = replace(OHQ850, OHQ850==9, NA)) |>
  mutate(OHQ860r = replace(OHQ860, OHQ860==9 | OHQ860==7, NA)) |>
  mutate (RIDSTATR = fct_recode(factor(RIDSTATR))) |>
  mutate(RIAGENDR = fct_recode(factor(RIAGENDR), "Male"="1", "Female"="2"))|>
  mutate(OHQ850r = fct_recode(factor(OHQ850r), "Treatment"="1", 
                              "No Treatment"="2"))|>
  mutate(OHQ860r = fct_recode(factor(OHQ860r), "Bone loss"="1", 
                              "No bone loss"="2"))  |>

  mutate(LBDHDD_2cat = case_when(LBDHDD < 60 ~ "At-risk", 
    TRUE ~ "Heart Healthy"), 
    LBDHDD_2cat = factor(LBDHDD_2cat))

 NEW3<- NEW3 |>
  rename(RIASEX = RIAGENDR)

```

I used the `inspect` function to confirm that all binary variables are factors with my specified category levels. `OHQ850r` has 7,743 missing values and `OHQ860r` has 7,772 missing values.

```{r}

NEW3 |>
  select(RIDSTATR, RIASEX, LBDHDD_2cat, OHQ850r, OHQ860r) |>
  mosaic::inspect()

```

## Multi-categorical Variables

There are two multi-categorical variables in the `NEW3` tibble: (1) `DMDMARTZ`: marital status and (2) `WHQ225`: the weight history survey question, "*How many times have you lost 10 pounds or more because you were trying to lose weight?*". I used the `tabyl` function to review the values in each variable and check for missing values.

```{r}

NEW3 |>
  tabyl(DMDMARTZ)|>
  kable()

NEW3 |>
  tabyl(WHQ225)|>
  kable()

```

I used the `mutate` function to treat values of "refused" and "don't know" for my `DMDMARTZ` and `WHQ225` variables as missing values. I also created two new factor variables with more meaningful levels:

-   `DMDMARTZF` has three levels for marital status including: (1) married/ living with a partner ("Married/Cohab"), (2) widowed/ divorced/ separated ("Wid/Div/Sep"), and (3) never married ("Never Married")

-   `WHQ225F` has five levels representing the number of times a subject has lost 10 lbs. or more with the goal of losing weight: (1) "Never", (2) 1-2 times ("1-2"), (3) 3-5 times ("3-5"), (4) 6-10 times ("6-10"), (5) 11+ times ("11+"). I used `fct_relevel` to reorder the categories so "Never" would appear first.

I have missing data for 6,338 subjects for `DMDMARTZF` and 5,417 subjects for `WHQ225F`.

```{r}

NEW3 <- NEW3 |>
  mutate(DMDMARTZ = replace(DMDMARTZ, DMDMARTZ==77 |DMDMARTZ==99, NA))|>
  
  mutate(WHQ225 = replace(WHQ225, WHQ225==7 |WHQ225==9, NA)) |>
  
  mutate(DMDMARTZF = fct_recode(factor(DMDMARTZ),"Married/ Cohab" = "1",
                                 "Wid/Div/Sep" = "2", "Never Married" = "3")) |>
  
  mutate (WHQ225F = fct_recode(factor(WHQ225), "1-2"="1", 
                                       "3-5"="2", "6-10"="3", 
                                      "11+" = "4", "Never" = "5"))  |>
  
  mutate(WHQ225F = fct_relevel(WHQ225F, "Never"))

NEW3 |>
  tabyl(DMDMARTZF)|>
  kable()

NEW3 |>
  tabyl(WHQ225F)|>
  kable()

```

## Creating My Analytic Tibble

I will conduct complete case analyses. I used the `complete.cases` function to omit rows containing "NA" values from my data set. I am willing to assume that these data are missing completely at random (MCAR). My analytic tibble, `nhanesHDL`, contains the variables that I will use in my analyses and will include in my codebook. I used the `filter` function to include only adult female subjects, ages 30-55, who have complete data on my chosen variables.

```{r}

nhanesHDL <-  NEW3 |>
 filter(RIDSTATR==2 & RIDAGEYR>29 & RIDAGEYR<56 & RIASEX=="Female") |>
 filter(complete.cases(LBDHDD))|> 
 filter(complete.cases(WHQ225F))|> 
 filter(complete.cases(DMDMARTZF))|> 
 filter(complete.cases(OHQ860r))|>
 filter(complete.cases(OHQ850r)) |>

  select(SEQN, RIDSTATR, RIDAGEYR, RIASEX, DMDMARTZ, DMDMARTZF, 
         LBDHDD, LBDHDD_2cat, WHQ225, WHQ225F, OHQ850, OHQ850r, OHQ860, OHQ860r)

```

## Missing Values Summary

I used the `miss_var_summary` function to demonstrate that my `nhanesHDL` tibble contains no missing data.

```{r}

miss_var_summary(nhanesHDL) |> 
   kbl(digits = 2) |> kable_classic()

```

# Codebook and Data Description

## Codebook

1,747 adult females, ages 30-55, who participated in NHANES 2017-2020 with complete data on the 14 variables included in my `nhanesHDL` tibble listed in the table below.

+---------------+--------+---------------------------------------------------------------------------------------------+---------------+
| Variable      | Type   | Description / Levels                                                                        | Original Name |
+===============+:======:+=============================================================================================+===============+
| `SEQN`        | ID     | 6-digit subject code                                                                        |               |
+---------------+--------+---------------------------------------------------------------------------------------------+---------------+
| `RIDSTATR`    | Binary | Interview/ Examination status of subject                                                    |               |
|               |        |                                                                                             |               |
|               |        | 2 levels: (1) Interview only, (2) Interview + Examination                                   |               |
+---------------+--------+---------------------------------------------------------------------------------------------+---------------+
| `RIDAGEYR`    | Quant  | Age at screening, in years (30-55)                                                          |               |
+---------------+--------+---------------------------------------------------------------------------------------------+---------------+
| `RIASEX`      | Binary | Biological sex of subject (Female or Male)                                                  | `RIAGENDR`    |
+---------------+--------+---------------------------------------------------------------------------------------------+---------------+
| `DMDMARTZF`   | Cat-3  | Marital status of subject                                                                   | `DMDMARTZ`    |
|               |        |                                                                                             |               |
|               |        | 3 levels: (1) Married/ Living Together, (2) Widowed/ Divorced/ Separated, (3) Never Married |               |
+---------------+--------+---------------------------------------------------------------------------------------------+---------------+
| `LBDHDD`      | Quant  | Direct High-Density Lipoprotein Cholesterol in mg/dL (5-189)                                |               |
|               |        |                                                                                             |               |
|               |        | Commonly referred to as "good cholesterol"                                                  |               |
+---------------+--------+---------------------------------------------------------------------------------------------+---------------+
| `LBDHDD_2cat` | Cat-2  | Direct High-Density Lipoprotein Cholesterol categories based on Cleveland Clinic guidelines |               |
|               |        |                                                                                             |               |
|               |        | 2 levels: (1) At-risk (HDL \<60 mg/dL), (2) Heart Healthy (HDL [\>]{.underline} 60 mg/dL)   |               |
+---------------+--------+---------------------------------------------------------------------------------------------+---------------+
| `WHQ225F`     | Cat-5  | How many times have you lost 10 lbs or more because you were trying to lose weight?         | `WHQ225`      |
|               |        |                                                                                             |               |
|               |        | 5 levels: (1) Never (2) 1-2 times, (3) 3-5 times, (4) 6-10 times, (5) 11+ times             |               |
+---------------+--------+---------------------------------------------------------------------------------------------+---------------+
| `OHQ850r`     | Binary | Ever had treatment for gum disease?                                                         | `OHQ850`      |
|               |        |                                                                                             |               |
|               |        | 2 levels: (1) Treatment, (2) No Treatment                                                   |               |
+---------------+--------+---------------------------------------------------------------------------------------------+---------------+
| `OHQ860r`     | Binary | Have you ever been told by a dental professional that you lost bone around your teeth?      | `OHQ860`      |
|               |        |                                                                                             |               |
|               |        | 2 levels: (1) Bone loss, (2) No bone loss                                                   |               |
+---------------+--------+---------------------------------------------------------------------------------------------+---------------+

## Analytic Tibble

My `nhanesHDL` tibble is printed below. I used the `is_tibble` function to confirm that `nhanesHDL` is a tibble.

```{r}

nhanesHDL

is_tibble(nhanesHDL)

```

## Data Summary

Below are the results of using the `Hmisc::describe` function on `nhanesHDL`.

```{r}

Hmisc::describe(nhanesHDL)

```

# Analysis B: Compare 2 Population Means using Independent Samples

## The Question

For Analysis B, I will compare `LBDHDD` by `OHQ860r`, using independent samples. I'll compare the mean HDL cholesterol in mg/dL (`LBDHDD`) of the population represented by adult females (ages 30 - 55) who have been told by a dental professional that they have dental bone loss, to the mean HDL cholesterol of the population represented by adult females (ages 30 - 55) who have never received that diagnosis. The two samples are not paired in any way and each sample includes a different number of subjects. I will use a 90% confidence level for the difference in means. I expect that adult females who have received this diagnosis will have lower (worse) mean HDL cholesterol than adult females who have not received this diagnosis.

**Research question:** Do adults females with a diagnosis of bone loss around their teeth have meaningfully different average HDL cholesterol measures than adult females with no diagnosis of bone loss around their teeth?

## Describing the Data

I created the `nhanesb` data set, containing only the variables I will use for this analysis as well as the `SEQN` subject identifier. I used `favstats` to create a numerical summary and to look at the range of the HDL values in `LBDHDD` within each dental diagnosis category of `OHQ860r.`

I have 209 subjects in the group of adult females who have been told by a dental professional that they have dental bone loss and 1,538 subjects in the group of adult females who have never received that diagnosis from a dental professional. Missing data were assumed to be missing completely at random (MCAR) and thus removed from the data set during the data development stage in order to run a complete cases analysis.

For the group of adult females who have received this dental diagnosis ("Bone loss" group), the range of HDL values is [26 - 119] mg/dL. For the sample of adult females who have never received this diagnosis ("No bone loss" group), the range of HDL vales is wider at [23 - 178] mg/dL. Values for the mean, median, and interquartile ranges of HDL cholesterol are pretty similar for both groups. The mean HDL is ever so slightly higher for adult females with no bone loss diagnosis (57.03 mg/dL vs 56.68 mg/dL) while the median HDL is slightly higher for subjects in the bone loss group (56 mg/dL vs 54 mg/dL).

```{r}

nhanesb <- nhanesHDL |>
  select(SEQN, LBDHDD, OHQ860r)

mosaic::favstats(LBDHDD ~ OHQ860r, data = nhanesb) |>
  kable(digits = 2)|> kable_classic()

```

I built a comparison boxplot with violin using `ggplot` to get an initial visualization of my outcome variable within each group. Neither group seems to be well approximated by the Normal distribution though this is more pronounced for the no bone loss group which is more right skewed (with mean HDL \> median HDL) and displays significant kurtosis with more outliers than I'd expect compared to a Normal distribution.

```{r}

ggplot(nhanesb, aes(x = OHQ860r, y = LBDHDD)) + 
  geom_violin(aes(fill = OHQ860r), alpha = 0.3) +
  geom_boxplot(width = .3, outlier.size=2, notch = TRUE) +
  stat_summary(fun="mean", geom="point", 
               shape=23, size=2.5, fill="darkgreen")+
  guides(fill = "none") +
  coord_flip()+
  labs(title = "Comparing HDL by Dental Bone Loss Diagnosis Status",
      subtitle = "in 1,747 NHANES adult females, ages 30 - 55",
      x = "Diagnosed with Bone Loss Around Teeth?", y = "HDL Cholesterol (mg/dL)")

```

I used the `ggplot` function to build a pair of Normal Q-Q plots. These plots support my previous observations regarding Normality. The no bone loss plot bends away from the straight reference line in the direction that indicates right-skew in my data. Moving forward with my analysis, I will avoid tests that require the assumption of Normality.

```{r}

ggplot(nhanesb, aes(sample = LBDHDD, color=factor(OHQ860r))) +
  geom_qq() + geom_qq_line() +
  facet_wrap(~ OHQ860r, labeller = "label_both") +
 guides(col = "none") +
  labs(y = "Observed HDL Cholesterol (mg/dL)",
       title = "Normal Q-Q Plot")

```

## Main Analysis

To complete this analysis, I selected the bootstrap approach to generate a 90% confidence interval. The two samples in my data are unbalanced, independent, and not normally distributed. Using the `bootdif` function and setting a random number seed, I calculated a 90% confidence interval for the difference in mean HDL cholesterol between my two groups. Based on my samples, the population mean HDL in adult females with a diagnosis of bone loss around their teeth is estimated to be about .35 mg/dL lower than the mean HDL in adult females who have never received this diagnosis. My 90% confidence interval for the difference (No Bone Loss - Bone Loss) of the population means is (-1.47, 2.22). Assuming a two-sided confidence interval, the difference between the true means of the HDL cholesterol for adult females with and without this particular dental diagnosis could be either positive or negative.

```{r}

set.seed(4312022) 

bootdif(nhanesb$LBDHDD, nhanesb$OHQ860r, conf.level = 0.90) |> 
  kable(digits = 4)|> kable_classic()

```

## Conclusions

My 90% confidence interval for the difference between the population mean HDL cholesterol for adult females ages 30 - 55 with and without diagnoses of dental bone loss include a range of possible values that cross zero, based on the comparison of my two samples. This conclusion is motivated by a bootstrap estimate comparing the two groups ("No bone loss" and "Bone loss") with complete data on both `LBDHDD` and `OHQ860r.` I chose this approach given the obvious skew in my data (particularly for the no bone loss group) as the bootstrap approach does not require assumptions of normality or equal population variances.

I anticipated that I would see higher (better) mean HDL cholesterol values in subjects who had not received a diagnosis of dental bone loss and lower (worse) mean HDL cholesterol values in subjects who had received this diagnosis. From the two groups in my sample, subjects in the no bone loss group did have a slightly higher mean HDL value (by .35 mg/dL) but I'm not able to conclude that the difference in means is detectably different from 0 based on this analysis and the confidence interval I calculated. In clinical settings, HDL values are reported as integers so even if my confidence interval had excluded 0, I'm not sure my result would indicate clinically meaningful differences for the values I observed in adult females in my two groups. Next steps could include examining HDL cholesterol in subjects who are currently experiencing dental bone loss and/or looking at subjects with untreated gum/ dental issues. My analysis did not account for subjects' current dental health status or whether those who had a diagnosis of dental bone loss had ever sought out treatment.

# Analysis C: Compare 3+ Population Means via ANOVA

## The Question

For Analysis C, I will compare `LBDHDD` by `WHQ225F` using an analysis of variance (ANOVA). I'll compare the mean HDL cholesterol in mg/dL (`LBDHDD`) of the five populations represented by adult females between the ages 30 - 55 who have:

-   Never lost 10+ lbs trying to lose weight

-   Lost 10+ lbs 1 to 2 times trying to lose weight

-   Lost 10+ lbs 3 to 5 times trying to lose weight

-   Lost 10+ lbs 6 to 10 times trying to lose weight

-   Lost 10+ lbs 11+ times trying to lose weight

My samples are independent with no link between any of the subjects across the five levels of `WHQ225F` listed above. Each group also includes a different number of subjects. I will use a 90% confidence level for the difference in population means. I expect that adult females who have fewer instances of losing 10+ pounds (never or 1-2 times) will have higher (better) mean HDL cholesterol, with increasing weight loss occurrences associated with lower (worse) mean HDL cholesterol.

**Research question:** How do average HDL cholesterol measures vary across the groups of adult females defined by the number of times they have lost 10+ pounds in order to lose weight?

## Describing the Data

I created the `nhanesc` data set, containing only the variables I will use for this analysis as well as the `SEQN` subject identifier. I used `favstats` to start my analysis by looking at numerical summaries and the range of the HDL cholesterol values within each weight loss category of `WHQ225F`.

My groups are unbalanced with a different number of subjects in each. The 6-10 and 11+ times groups have significantly fewer subjects than the other three groups. The means, medians, interquartile ranges, and variances do not appear to differ very much between the groups. The mean HDL cholesterol values don't progressively increase as the number of weight loss occurrences increase as I originally thought they might. Mean and median HDL cholesterol values are lowest (worst) for adult females who have lost 10+ lbs 3-5 times (54.87 mg/dL and 53 mg/dL, respectively). Adult females in the 11+ times category actually have the greatest mean and median HDL cholesterol (59.22 mg/dL and 57 mg/dL, respectively). The interquartile ranges are very similar across groups (all ranging from 18 - 21 mg/dL).

Missing data was assumed to be missing completely at random (MCAR) and was removed from the data set during the data development stage in order to run a complete cases analysis.

```{r}

nhanesc <- nhanesHDL |>
  select(SEQN, LBDHDD, WHQ225F) |>
  mutate(WHQ225F = fct_relevel(WHQ225F, "Never"))

mosaic::favstats(LBDHDD ~ WHQ225F, data = nhanesc) |>
  kable(digits = 2)|> kable_classic()

```

I used `ggplot` to build graphical summaries to explore the distributions of my five independent samples. Taking a look at the comparison boxplot and faceted histograms, I can see that most of my groups exhibit meaningful right skew (with mean HDL \> median HDL for each) and kurtosis with more outliers than I'd expect compared to a Normal distribution for the Never, 1-2 times, and 3-5 times groups.

```{r}

ggplot(nhanesc, aes(x = WHQ225F, y = LBDHDD, 
                            fill = WHQ225F)) + 
  geom_violin(alpha = 0.3) +
  geom_boxplot(width = 0.3, notch = TRUE) +
  guides(fill = "none") +
  scale_fill_brewer(palette = "Spectral", direction = 1) +

  labs(title = "Comparing HDL Across Weight Loss Groups",
       subtitle = "in 1,747 NHANES adult females, ages 30 - 55",
       x = "Times Lost 10 lbs or more to lose weight", 
       y = "HDL Cholesterol (mg/dL)") 


 ggplot(nhanesc, aes(x = LBDHDD)) +
  geom_histogram(aes(fill = WHQ225F), bins = 10, col = "black") +
  facet_wrap(~ WHQ225F, labeller = "label_both") +
  guides(fill = "none") +
    scale_fill_brewer(palette = "Spectral", direction = 1) +

  labs(title = "HDL by Number of Weight Loss Occurrences", 
       subtitle = "in 1,747 NHANES adult females, ages 30 - 55",
       y = "count",
       x = "HDL Cholesterol (mg/dL)")

```

## Main Analysis

I started with the Kruskal-Wallis test comparing population measures of location for my independent samples without assuming Normality. None of my samples appeared to be well approximated by a Normal distribution and all displayed right skew, some more severely than others. I compared the centers of the distributions of population HDL cholesterol values across my five weight loss categories. The results suggest there is separation between the HDL cholesterol values for the five weight loss categories consistent with some true differences between those groups. At least one group has its distribution center shifted relative to the other groups (p\<.1).

```{r}

kruskal.test(LBDHDD ~ WHQ225F, data = nhanesc)

```

I continued with an analysis of variance to compare the means of `LBDHDD` in the five `WHQ225F` populations. ANOVA is quite robust so I can worry less about potential Normality violations when making comparisons. My results are inconsistent with the assumption that there are no differences between the population mean HDL cholesterol values for the five weight loss categories (p\<.1). However, the weight loss categories account for less than 1% of the variation seen in HDL cholesterol in my sample (η2=.007).

```{r}

lm(LBDHDD ~ WHQ225F, data = nhanesc) |>
  anova()

aov(nhanesc$LBDHDD ~ nhanesc$WHQ225F) |> summary()

```

I used Tukey's Honestly Significant Difference (HSD) test to make pairwise comparisons between the five weight loss groups using a 90% confidence level across the set of comparisons. Detectable differences in mean HDL cholesterol exist only between the 3-5 times group and the Never group at a 90% confidence interval (-6.33, -.83) with the mean HDL for the Never group 3.57 mg/dL higher than mean HDL for the 3-5 times group. All other comparisons reveal group differences in the mean that could have either sign. 90% confidence intervals for the comparisons between the 1-2 times and Never groups as well as between the 11+ times and 3-5 times groups only just include 0.

```{r}

TukeyHSD(aov(nhanesc$LBDHDD ~ nhanesc$WHQ225F), conf.level = 0.90)

```

I included a plot of the Tukey HSD results to visualize these comparisons more clearly.

```{r}

mar.default <- c(5,6,4,2) + 0.1
par(mar = mar.default + c(0, 4, 0, 0))
plot(TukeyHSD(aov(nhanesc$LBDHDD ~ nhanesc$WHQ225F),
              conf.level = 0.90), las = 1)

```

## Conclusions

There is minimal evidence for differences in average HDL cholesterol across the `WHQ225F` categories according to both ANOVA and Kruskal-Wallis approaches at 90% confidence levels. Specifically, when comparing adult female subjects who have never lost 10+ lbs with those subjects who have lost 10+ lbs 3-5 times. Initially, I anticipated seeing higher (better) HDL cholesterol values in adult females who reported fewer instances of losing 10+ lbs. The mean HDL cholesterol was actually highest for adult females who reported losing 10+ pounds 11 or more times (59.22 mg/dL). While the mean HDL for adult females who reported never losing 10+ lbs was comparable at 58.44 mg/dL, I was still surprised by that observation.

Ultimately, the weight loss categories accounted for less than 1% of the variation in HDL cholesterol for subjects in my sample which doesn't indicate much practical or clinical value. I believe the `WHQ225F` variable has some limitations. I wasn't able to account for subject weight before or after each weight loss attempt and I can't know whether the women in my sample have engaged in cycles of weight gain/loss (often termed "yo-yo" dieting) or whether they've only seen their weight decrease with each weight loss occurrence. There are other reasons women might try to lose weight multiple times that don't amount to yo-yo dieting such as trying to lose weight after childbirth. Next steps for analysis should include examining additional measures in conjunction with weight loss occurrences (weight, BMI) and possibly including some qualitative measures to better understand subject mindset and goals surrounding their weight loss attempts.

Another important limitation to note is my use of Tukey's HSD test, despite the right skew in my data and the uneven group sizes within each category. I decided to run this test as a follow up to my ANOVA test.

# Analysis D: Two-Way (2x2) Contingency Table

## The Question

For Analysis D, I will look at the association of `LBDHDD_2cat` and `OHQ850r` in adult females ages 30 - 55. Each of my variables has two levels. `LBDHDD_2cat` groups subjects into an At-risk category (HDL \< 60 mg/dL) and a Heart-Healthy category (HDL \>= 60 mg/dL). The levels of `OHQ850r` indicate whether the subject has ever received treatment for gum disease (Treatment group and No Treatment group). I am interested in whether `OHQ850r` has an impact on `LBDHDD_2cat` and will build a two-way contingency table to explore the relationship. `OHQ850r` will be in the rows and `LBDHDD_2cat` will be in the columns. I will use a 90% confidence level and the Bayesian augmentation in which I add two successes and two failures to each cell.

**Research question:** Is there an association between being treated for gum disease and HDL cholesterol levels for adult females, ages 30-55?

## Describing the Data

I created the `nhanesd` data set, containing only the variables I'm using for this analysis as well as the `SEQN` subject identifier. My 2x2 contingency table includes 400 subjects who have had treatment for gum disease, 168 with HDL cholesterol in the heart-healthy range and 232 with HDL cholesterol in the at-risk range. 1,347 subjects have never undergone treatment for gum disease, 485 with heart-healthy HDL cholesterol levels and 862 with at-risk HDL cholesterol.

Missing data were assumed to be missing completely at random (MCAR) and thus removed from the data set during the data development stage in order to run a complete cases analysis.

```{r}

nhanesd <- nhanesHDL |>
  select(SEQN, OHQ850r, LBDHDD, LBDHDD_2cat) |>
  mutate(LBDHDD_2cat = fct_relevel(LBDHDD_2cat, "Heart Healthy"))


nhanesd |>
  tabyl(OHQ850r, LBDHDD_2cat) |>
  adorn_totals(where = c("row", "col"))

```

## Main Analysis

I used the `twoby2` function to complete the 2x2 table analysis, using Bayesian augmentation. I estimate that the probability of having heart-healthy HDL cholesterol among adult females who have undergone gum disease treatment is .42, with 90% confidence interval (.38, .46) whereas my estimate of the probability of heart-healthy HDL cholesterol among adult females who have never had treatment for gum disease is .36, with 90% confidence interval (.34, .38).

The relative risk of heart-healthy HDL cholesterol given gum disease treatment vs. heart-healthy HDL cholesterol given no gum disease treatment is estimated to be 1.17 with 90% confidence interval entirely greater than 1, indicating that the probability of heart-healthy HDL cholesterol is higher for adult female subjects who have been treated for gum disease than it is for adult female subjects who have not been treated for gum disease.

The odds ratio describing the odds of heart-healthy HDL cholesterol given gum disease treatment vs. no gum disease treatment is estimated to be 1.29 and is detectably greater than 1 at α=.10, indicating the odds of heart-healthy HDL cholesterol are higher for adult females who have been treated for gum disease than for adult females who have not received this treatment.

The difference in probability of heart-healthy HDL cholesterol for subjects treated for gum disease vs. subjects not treated for gum disease is estimated to be .06 and is detectably different from 0 at α=.10, indicating that the probability of heart-healthy HDL is higher for adult females treated for gum disease.

Since every cell in my 2x2 table, before augmentation, included at least 10 subjects, I'm comfortable using the chi-square test of independence to assess my null hypothesis. The null hypothesis states that there is no association between gum disease treatment and HDL cholesterol. Both the Fisher's exact test and Pearson chi-square test resulted in (p \< .1), supporting my decision to reject the null hypothesis.

```{r}

t1 <- table(nhanesd$OHQ850r, nhanesd$LBDHDD_2cat)

twoby2(t1 + 2, conf.level = 0.90) 

```

## Conclusions

The 90% confidence intervals that I built for the relative risk and odds ratio of subjects exhibiting heart-healthy HDL cholesterol levels given that they've undergone gum disease treatment did not cross 1. The probability difference was detectably different from 0. My chi-square test of independence yielded (p\<.1). Taken together, these results support my decision to reject the null hypothesis that there is no association between HDL cholesterol levels and gum disease treatment.

Adult female subjects, ages 30-55, who have received treatment for gum disease, have a higher probability of exhibiting heart-healthy HDL cholesterol levels than do adult female subjects who have never undergone gum disease treatment. Initially, I expected to see a lower probability of heart-healthy HDL cholesterol levels for adult females who had been treated for gum disease, equating past treatment with current presence of gum disease.

Being treated for gum disease would logically indicate the presence of gum disease at some point, but the `OHQ850r` variable might actually tell us more about a subject's ability to access dental health services rather than their current dental health status. An absence of gum disease treatment is not the same as an absence of gum disease. It's entirely possible that adult females who have never been treated for gum disease actually have dental/ gum issues, but are unable or unwilling to receive treatment due to other factors (being uninsured or underinsured, lack of dental services in the community, never having established care with a dentist, transportation issues, etc.). Adult females who have been treated for gum disease probably also have adequate medical insurance and thus might have had any past HDL concerns addressed by a physician. Next steps could include looking at HDL cholesterol levels of patients at the time of gum disease diagnosis and/or before the patient receives treatment.

# Analysis E: Two-Way (3x2) Contingency Table

## The Question

For Analysis E, I will look at the association of `LBDHDD_2cat` and `DMDMARTZF` in adult females ages 30 - 55. `LBDHDD_2cat` groups subjects into an At-risk category (HDL \< 60 mg/dL) and a Heart-Healthy category (HDL \>= 60 mg/dL). `DMDMARTZF` has three levels corresponding to a subject's marital status including: (1) Married/ Living with Partner, (2) Widowed, Divorced, Separated, or (3) Never Married. I am interested in whether `DMDMARTZF` has an impact on `LBDHDD_2cat` and will build a two-way 3X2 contingency table to explore the relationship. `DMDMARTZF` will be in the rows and `LBDHDD_2cat` will be in the columns. I will use a 90% confidence level for this analysis.

**Research question:** Is there an association between marital status and HDL cholesterol levels for adult females, ages 30-55?

## Describing the Data

I created the `nhanese` data set, containing only the variables I'm using for this analysis as well as the `SEQN` subject identifier. My initial table satisfies the Cochran conditions with every cell containing counts of 5 or more and no cells with 0 counts. My married/ living with a partner group contains more than 3 times the number of subjects in my other two marital status groups. 653 subjects have heart-healthy HDL levels and 1,094 subjects have at-risk HDL cholesterol levels.

Missing data were assumed to be missing completely at random (MCAR) and thus removed from the data set during the data development stage in order to run a complete cases analysis.

```{r}

nhanese <- nhanesHDL |>
  select(SEQN, DMDMARTZF, LBDHDD, LBDHDD_2cat)|>
  mutate(LBDHDD_2cat = fct_relevel(LBDHDD_2cat, "Heart Healthy"))

nhanese |>
  tabyl(DMDMARTZF, LBDHDD_2cat) |>
  adorn_totals(where = c("row", "col"))

```

## Main Analysis

Having met the Cochran conditions described earlier, I decided to use the Pearson chi square test to analyze my 3x2 contingency table. My analysis resulted in a chi-square test statistic of .83 on 2 degrees of freedom, yielding (p\>.1), leading me to conclude that the rows and columns in my table are independent and that I should retain my null hypothesis within this setting.

```{r}

tableE <- table(nhanese$DMDMARTZF, nhanese$LBDHDD_2cat)

chisq.test(tableE)

```

The tables below include my observed and expected frequencies within each cell of my 3x2 table.

```{r}

res <- nhanese |> tabyl(DMDMARTZF, LBDHDD_2cat) |> chisq.test()

res$observed

res$expected

opar <- par(las = 1, cex = 0.8, mar = c(5,7,2,1))

```

I used the `assocplot` function to create a visualization for the results of my Pearson chi square test. Three of my cells had observed frequencies that were greater than the expected frequencies, represented by the blue boxes rising above the baseline indicating independence (adult females with heart-healthy HDL cholesterol who were married/ living with their partners; and adult females with at-risk HDL cholesterol who were either widowed/divorced/separated or never married). The other three cells had observed frequencies that were lower than the expected frequencies, represented on the plot by the red boxes below the baseline indicating independence. The independence model inverts its errors for the at-risk HDL categories as compared to the heart-healthy HDL categories.

```{r}

assocplot(tableE, col=c("lightblue", "tomato"), 
  main="Association Plot for 3x2 Table: HDL Cholesterol and Marital Status", 
          xlab="Marital Status", ylab="HDL Cholesterol")
title(ylab="HDL Cholesterol Categories", line=6)

```

## Conclusions

Using my 3x2 contingency table and the Pearson chi square test, I detect no strong association between a subject's marital status and her HDL cholesterol levels. Initially, I expected that I might observe an association between `LBDHDD_2cat` and `DMDMARTZF` such that adult females who were married or living with a partner would be less likely to display at-risk HDL cholesterol levels.

Among married subjects, 62% had at-risk HDL levels. Among subjects who were widowed/ divorced/ or separated, 63% had at-risk HDL. And, among subjects who had never been married, 65% exhibited at-risk HDL. My analysis suggested that I retain the null hypothesis that there's no detectable association between an adult female's marital status and her HDL cholesterol levels. That is, the rows and columns of my 3x2 contingency table are independent.

From my association plot, it looks like the independence assumption holds up best for adult females in the widowed/ divorced/ separated categories in that my observed frequencies were pretty close to my expected frequencies. This assumption holds up less well for adult females in the never married and married/ living with a partner categories but the effect that I observed is not big enough to assume that the association is statistically detectable. The observed frequencies within each cell were close enough to the expected frequencies that I will retain my null hypothesis of independence.

There is a lot of variation in relationship status and satisfaction that is not reflected in the `DMDMARTZF` variable. Next steps could include an examination of different relationship and mental health measures (healthy vs disordered relationships; depression and loneliness, etc.) and their impact on HDL cholesterol.

# Session Information

```{r}

sessionInfo()

```
